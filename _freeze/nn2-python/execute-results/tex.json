{
  "hash": "705c475f86eb6b2c08e86d9f697dc59b",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Recurrent Neural Network (LSTM) â€” Sine Wave\"\nformat:\n  html:\n    code-fold: false\n  pdf:\n    toc: true\njupyter: python3\nexecute:\n  python: \"/Users/donaldhale/r-arm/bin/python\"\n\n---\n\n# LSTM on a Sine Wave\n\nThis chapter reproduces the R RNN chapter using Python, using a sine wave and manual RMSE.\n\n---\n\n## 1. Generate Sine Wave\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nn_points = 2000\nt = np.linspace(0, 40*np.pi, n_points)\nsignal = np.sin(t)\n\nplt.plot(t, signal)\nplt.title(\"Sine Wave\")\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](nn2-python_files/figure-pdf/cell-2-output-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n---\n\n## 2. Build Sequences\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\ndef create_sequences(series, seq_length=50):\n    X_list, y_list = [], []\n    for i in range(len(series) - seq_length):\n        X_list.append(series[i:i+seq_length])\n        y_list.append(series[i+seq_length])\n    X = np.array(X_list)[..., np.newaxis]\n    y = np.array(y_list)\n    return X, y\n\nseq_length = 50\nX_seq, y_seq = create_sequences(signal, seq_length)\n```\n:::\n\n\n---\n\n## 3. Train/Test Split\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nsplit = int(0.8 * X_seq.shape[0])\n\nX_train_seq = X_seq[:split]\ny_train_seq = y_seq[:split]\nX_test_seq = X_seq[split:]\ny_test_seq = y_seq[split:]\n```\n:::\n\n\n---\n\n## 4. LSTM Model\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\n# import tensorflow as tf\n# from tensorflow import keras\n# from tensorflow.keras import layers\n# from sklearn.metrics import mean_squared_error\n# \n# tf.random.set_seed(12345)\n# \n# model = keras.Sequential([\n#     layers.LSTM(32, input_shape=(seq_length,1)),\n#     layers.Dense(1)\n# ])\n# \n# model.compile(optimizer=\"adam\", loss=\"mse\")\n# model.summary()\n```\n:::\n\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\n# history = model.fit(\n#     X_train_seq, y_train_seq,\n#     epochs=20, batch_size=32,\n#     validation_split=0.2, verbose=0\n# )\n# \n# plt.plot(history.history[\"loss\"], label=\"Train\")\n# plt.plot(history.history[\"val_loss\"], label=\"Val\")\n# plt.legend()\n# plt.title(\"LSTM Loss\")\n# plt.show()\n```\n:::\n\n\n---\n\n## 5. Evaluate\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\n# pred_seq = model.predict(X_test_seq).flatten()\n# \n# rmse_lstm = mean_squared_error(y_test_seq, pred_seq) ** 0.5\n# rmse_lstm\n```\n:::\n\n\n",
    "supporting": [
      "nn2-python_files/figure-pdf"
    ],
    "filters": []
  }
}